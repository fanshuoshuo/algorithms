<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>AntiFloyd</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type>
<META name=GENERATOR content="MSHTML 8.00.7600.16722"></HEAD>
<BODY><BASEFONT face=ARIAL>
<P>
<CENTER><FONT size=6><B>Problem F</B></FONT><BR><FONT 
size=5><B>AntiFloyd</B></FONT><BR><FONT size=4>Time Limit: 2 seconds</FONT> 
</CENTER>
<P></P>
<P align=right>
<TABLE border=0>
  <TBODY>
  <TR>
    <TD><SMALL><I>"There is nothing new under the sun but<BR>there are lots of 
      old things we don't know."</I> </SMALL></TD></TR></TBODY></TABLE><TT>Ambrose 
Bierce</TT> </SMALL></P>
<P class=paragraph>You have been hired as a systems administrator for a large 
company. The company head office has <B>n</B> computers connected by a network 
of <B>m</B> cables. Each cable connects two different computers, and there is at 
most one cable connecting any given pair of computers. Each cable has a latency, 
measured in micro-seconds, that determines how long it takes for a message to 
travel along that cable. The network protocol is set up in a smart way, so that 
when sending a message from computer A to computer B, the message will travel 
along the path that has the smallest total latency, so that it arrives at B as 
soon as possible. The cables are bi-directional and have the same latency in 
both directions. </P>
<P class=paragraph>As your first order of business, you need to determine which 
computers are connected to each other, and what the latency is along each of the 
<B>m</B> cables. You soon discover that this is a difficult task because the 
building has many floors, and the cables are hidden inside walls. So here is 
what you decide to do. You will send a message from every computer A to every 
other computer B and measure the latency. This will give you 
<NOBR><B>n</B>(<B>n</B>-1)/2</NOBR> measurements. From this data, you will 
determine which computers are connected by cables, and what the latency along 
each cable is. You would like your model to be simple, so you want to use as few 
cables as possible. </P>
<P class=paragraph><FONT size=5><B>Input</B></FONT><BR>The first line of input 
gives the number of cases, <B>N</B> (at most 20). <B>N</B> test cases follow. 
Each one starts with a line containing <B>n</B> (0&lt;<B>n</B>&lt;100). The next 
<NOBR><B>n</B>-1</NOBR> lines will contain the message latency measurements. 
Line <B>i</B> will contain <B>i</B> integers in the range <NOBR>[1, 
10000]</NOBR>. Integer <B>j</B> is the amount of time it takes to send a message 
from computer <NOBR><B>i</B>+1</NOBR> to computer <B>j</B> (or back). </P>
<P class=paragraph><FONT size=5><B>Output</B></FONT><BR>For each test case, 
output a line containing "Case #<B>x</B>:". The next line should contain 
<B>m</B> - the number of cables. The next <B>m</B> lines should contain 3 
integers each: <B>u</B>, <B>v</B> and <B>w</B>, meaning that there is a cable 
between computers <B>u</B> and <B>v</B>, and it has latency <B>w</B>. Lines 
should be sorted first by <B>u</B>, then by <B>v</B>, with 
<NOBR><B>u</B>&lt;<B>v</B></NOBR>. If there are multiple answers, any one will 
do. If the situation is impossible, print "Need better measurements." Print an 
empty line after each test case. </P>
<TABLE border=1 cellSpacing=0 borderColor=black cellPadding=5 width="100%">
  <TBODY>
  <TR vAlign=top>
    <TD><FONT size=5><B>Sample Input</B></FONT> </TD>
    <TD><FONT size=5><B>Sample Output</B></FONT> </TD></TR>
  <TR vAlign=top bgColor=#d0d0d0>
    <TD><PRE>2
3
100
200 100
3
100
300 100
</PRE></TD>
    <TD><PRE>Case #1:
2
1 2 100
2 3 100

Case #2:
Need better measurements.

</PRE></TD></TR></TBODY></TABLE>
<P>
<HR>
<B>Problemsetter: Igor Naverniouk<BR>Alternate solution: Frank Chu</B> 
<P></P></TD></TR></TABLE></BASEFONT></BODY></HTML>
